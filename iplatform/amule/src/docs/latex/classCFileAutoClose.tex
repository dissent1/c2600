\section{CFileAutoClose Class Reference}
\label{classCFileAutoClose}\index{CFileAutoClose@{CFileAutoClose}}


This class encapsulates the \doxyref{CFile}{p.}{classCFile} class.  


{\ttfamily \#include $<$FileAutoClose.h$>$}\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf CFileAutoClose} ()\label{classCFileAutoClose_a6d7ef056268e34278641fc47808b6819}

\item 
{\bf CFileAutoClose} (const {\bf CPath} \&path, {\bf CFile::OpenMode} mode=CFile::read)
\item 
bool {\bf Release} (bool now=false)
\item 
bool {\bf Open} (const {\bf CPath} \&path, {\bf CFile::OpenMode} mode=CFile::read)
\item 
bool {\bf Create} (const {\bf CPath} \&path, bool overwrite=false)
\item 
bool {\bf Close} ()
\item 
uint64 {\bf GetLength} () const 
\item 
bool {\bf SetLength} (uint64 newLength)\label{classCFileAutoClose_a44cf917d6220c5f9c7298f80d687c368}

\item 
const {\bf CPath} \& {\bf GetFilePath} () const \label{classCFileAutoClose_aca9216dc7cd06c99b2d1b3a9a34d7f44}

\item 
bool {\bf IsOpened} () const \label{classCFileAutoClose_a3f9be385ed8d2c347dd982d98948cfbe}

\item 
void {\bf ReadAt} (void $\ast$buffer, uint64 offset, size\_\-t count)
\item 
void {\bf WriteAt} (const void $\ast$buffer, uint64 offset, size\_\-t count)
\item 
bool {\bf Eof} ()\label{classCFileAutoClose_a2e569ec8e2e847c6af79c5bf5fada3b5}

\item 
int {\bf fd} ()
\item 
void {\bf Unlock} ()\label{classCFileAutoClose_aa585edf2195a8a3bd620d095bb2813d4}

\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf Reopen} ()\label{classCFileAutoClose_aa71d0d5ffe4da7f411e751a58fd17dd5}

\end{DoxyCompactItemize}
\begin{Indent}{\bf }\par
{\em \label{_amgrpd41d8cd98f00b204e9800998ecf8427e}
 }\begin{DoxyCompactItemize}
\item 
{\bf CFileAutoClose} (const {\bf CFileAutoClose} \&)\label{classCFileAutoClose_afe173d1aec0dded8c939d4f24ee40e33}

\item 
{\bf CFileAutoClose} \& {\bfseries operator=} (const {\bf CFileAutoClose} \&)\label{classCFileAutoClose_a556de78ef7985cecd9d30ffb0d9d4bb3}

\end{DoxyCompactItemize}
\end{Indent}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf CFile} {\bf m\_\-file}\label{classCFileAutoClose_a0da5e36e648de49a47dd77843c52bcb9}

\item 
{\bf CFile::OpenMode} {\bf m\_\-mode}\label{classCFileAutoClose_a798581ea1bfd9cb6644865a65af04f1d}

\item 
bool {\bf m\_\-autoClosed}\label{classCFileAutoClose_a3d71f2937c850404a784f0bb7762af66}

\item 
uint16 {\bf m\_\-locked}\label{classCFileAutoClose_a58a2fe9995dd176338b3a235d19a52fe}

\item 
uint64 {\bf m\_\-size}\label{classCFileAutoClose_a90d355f3fea73e3698cdaf14a9a775c3}

\item 
uint32 {\bf m\_\-lastAccess}\label{classCFileAutoClose_a11b71165bd04e2a239d720ec17e144ff}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class encapsulates the \doxyref{CFile}{p.}{classCFile} class. It allows to close the used file handle and reopen it on usage to minimize the number of used file handles. 

\subsection{Constructor \& Destructor Documentation}
\index{CFileAutoClose@{CFileAutoClose}!CFileAutoClose@{CFileAutoClose}}
\index{CFileAutoClose@{CFileAutoClose}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{CFileAutoClose}]{\setlength{\rightskip}{0pt plus 5cm}CFileAutoClose::CFileAutoClose (const {\bf CPath} \& {\em path}, \/  {\bf CFile::OpenMode} {\em mode} = {\ttfamily CFile::read})}\label{classCFileAutoClose_ab8d4baf5923d3af54eda87a629972e30}


Constructor, calls Open on the specified file. To check if the file was successfully opened, a call to \doxyref{IsOpened()}{p.}{classCFileAutoClose_a3f9be385ed8d2c347dd982d98948cfbe} is required. 

References Open().

\subsection{Member Function Documentation}
\index{CFileAutoClose@{CFileAutoClose}!Close@{Close}}
\index{Close@{Close}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{Close}]{\setlength{\rightskip}{0pt plus 5cm}bool CFileAutoClose::Close ()}\label{classCFileAutoClose_ae361e443fe6e4421eec7793cb6c87409}


Closes the file. Note that calling Close on an closed file is an illegal operation. 

References CFile::Close(), m\_\-autoClosed, and m\_\-file.\index{CFileAutoClose@{CFileAutoClose}!Create@{Create}}
\index{Create@{Create}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{Create}]{\setlength{\rightskip}{0pt plus 5cm}bool CFileAutoClose::Create (const {\bf CPath} \& {\em path}, \/  bool {\em overwrite} = {\ttfamily false})}\label{classCFileAutoClose_ae890bf901d0eaea4264d9b9c139e6df5}


Calling Create is equivilant of calling open with OpenMode 'write'. 
\begin{DoxyParams}{Parameters}
\item[{\em overwrite}]Specifies if the target file should be overwritten, in case that it already exists.\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\doxyref{CFile::Open}{p.}{classCFile_a276f41388fbdd393dc446b02e1ba8ad0} 
\end{DoxySeeAlso}


References CFile::Create(), m\_\-autoClosed, m\_\-file, m\_\-lastAccess, and m\_\-mode.\index{CFileAutoClose@{CFileAutoClose}!fd@{fd}}
\index{fd@{fd}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{fd}]{\setlength{\rightskip}{0pt plus 5cm}int CFileAutoClose::fd ()}\label{classCFileAutoClose_a7352d831378cc648df0ae2b0456e31a5}


Returns the file descriptior assosiated with the file. This breaks the purpose of this class of course. Therefore the AutoClose mechanism is disabled when \doxyref{fd()}{p.}{classCFileAutoClose_a7352d831378cc648df0ae2b0456e31a5} is called. It's required for FileArea's mmap stuff. Currently FileArea objects are shortlived enough for this not being a problem anyway, but that might change in the future. 

References CFile::fd(), m\_\-file, m\_\-locked, and Reopen().

Referenced by CFileArea::ReadAt().\index{CFileAutoClose@{CFileAutoClose}!GetLength@{GetLength}}
\index{GetLength@{GetLength}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{GetLength}]{\setlength{\rightskip}{0pt plus 5cm}uint64 CFileAutoClose::GetLength () const}\label{classCFileAutoClose_a3e67f15471439c5e3247e39305b85069}
\begin{DoxySeeAlso}{See also}
CSafeFileIO::GetLength
\end{DoxySeeAlso}
Note that calling GetLength on a closed file is an illegal operation. 

References CFile::GetLength(), m\_\-autoClosed, m\_\-file, and m\_\-size.

Referenced by CHashingTask::Entry().\index{CFileAutoClose@{CFileAutoClose}!Open@{Open}}
\index{Open@{Open}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{Open}]{\setlength{\rightskip}{0pt plus 5cm}bool CFileAutoClose::Open (const {\bf CPath} \& {\em path}, \/  {\bf CFile::OpenMode} {\em mode} = {\ttfamily CFile::read})}\label{classCFileAutoClose_a63184609fc4759f33d9330dcb8515f1a}


Opens a file. 
\begin{DoxyParams}{Parameters}
\item[{\em path}]The full or relative path to the file. \item[{\em mode}]The opening mode (see \doxyref{CFile}{p.}{classCFile}). \end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the file was opened, false otherwise. 
\end{DoxyReturn}


References m\_\-autoClosed, m\_\-file, m\_\-lastAccess, m\_\-locked, m\_\-mode, m\_\-size, and CFile::Open().

Referenced by CFileAutoClose(), and CHashingTask::Entry().\index{CFileAutoClose@{CFileAutoClose}!ReadAt@{ReadAt}}
\index{ReadAt@{ReadAt}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{ReadAt}]{\setlength{\rightskip}{0pt plus 5cm}void CFileAutoClose::ReadAt (void $\ast$ {\em buffer}, \/  uint64 {\em offset}, \/  size\_\-t {\em count})}\label{classCFileAutoClose_a8679220d4eb55f60fef2f9ee9e5c946c}


Reads 'count' bytes into 'buffer'. 
\begin{DoxyParams}{Parameters}
\item[{\em buffer}]The target buffer. \item[{\em offset}]The seek address in the file. \item[{\em count}]The number of bytes to read.\end{DoxyParams}
See \doxyref{CFileDataIO::Read}{p.}{classCFileDataIO_af64cff2ab84643e7fdcd2b4366fece27} 

References m\_\-file, CFileDataIO::Read(), Reopen(), and CFileDataIO::Seek().

Referenced by CFileArea::ReadAt().\index{CFileAutoClose@{CFileAutoClose}!Release@{Release}}
\index{Release@{Release}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{Release}]{\setlength{\rightskip}{0pt plus 5cm}bool CFileAutoClose::Release (bool {\em now} = {\ttfamily false})}\label{classCFileAutoClose_ad637900755ff47326023f1053e8550ba}


Request auto closing of the file handle. 
\begin{DoxyParams}{Parameters}
\item[{\em now}]true: close immediately false: close when timeout has expired \end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the file has been (or has already been) autoclosed. 
\end{DoxyReturn}


References CFile::Close(), GetFilePath(), CFile::GetLength(), CFile::IsOpened(), m\_\-autoClosed, m\_\-file, m\_\-lastAccess, m\_\-locked, and m\_\-size.\index{CFileAutoClose@{CFileAutoClose}!WriteAt@{WriteAt}}
\index{WriteAt@{WriteAt}!CFileAutoClose@{CFileAutoClose}}
\subsubsection[{WriteAt}]{\setlength{\rightskip}{0pt plus 5cm}void CFileAutoClose::WriteAt (const void $\ast$ {\em buffer}, \/  uint64 {\em offset}, \/  size\_\-t {\em count})}\label{classCFileAutoClose_a077ff3037a44ae331816ced403628424}


Write 'count' bytes from 'buffer' into the file. 
\begin{DoxyParams}{Parameters}
\item[{\em buffer}]The source-\/data buffer. \item[{\em offset}]The seek address in the file. \item[{\em count}]The number of bytes to write.\end{DoxyParams}
See \doxyref{CFileDataIO::Write}{p.}{classCFileDataIO_a4ea42d721c52cb8df7679f27e899a2e3} 

References m\_\-file, Reopen(), CFileDataIO::Seek(), and CFileDataIO::Write().

Referenced by CFileArea::FlushAt().

The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/FileAutoClose.h\item 
src/FileAutoClose.cpp\end{DoxyCompactItemize}
