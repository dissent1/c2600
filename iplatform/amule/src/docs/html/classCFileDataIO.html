<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>aMule: CFileDataIO Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CFileDataIO Class Reference</h1><!-- doxytag: class="CFileDataIO" -->
<p>This class provides a interface for safe file IO.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SafeFile_8h_source.html">SafeFile.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CFileDataIO:</div>
<div class="dynsection">
 <div class="center">
  <img src="classCFileDataIO.gif" usemap="#CFileDataIO_map" alt=""/>
  <map id="CFileDataIO_map" name="CFileDataIO_map">
<area href="classCFile.html" alt="CFile" shape="rect" coords="0,56,148,80"/>
<area href="classCMemFile.html" alt="CMemFile" shape="rect" coords="158,56,306,80"/>
<area href="classCRC4EncryptableBuffer.html" alt="CRC4EncryptableBuffer" shape="rect" coords="158,112,306,136"/>
</map>
 </div>
</div>

<p><a href="classCFileDataIO-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a626e2cb012fd4db2b7af3981e9921733"></a><!-- doxytag: member="CFileDataIO::~CFileDataIO" ref="a626e2cb012fd4db2b7af3981e9921733" args="()" -->
virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a626e2cb012fd4db2b7af3981e9921733">~CFileDataIO</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6b153f389378a4f72ac09c56a6a60230"></a><!-- doxytag: member="CFileDataIO::GetPosition" ref="a6b153f389378a4f72ac09c56a6a60230" args="() const =0" -->
virtual uint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a6b153f389378a4f72ac09c56a6a60230">GetPosition</a> () const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7f54fcd57c88023b87f7e4535becab0a"></a><!-- doxytag: member="CFileDataIO::GetLength" ref="a7f54fcd57c88023b87f7e4535becab0a" args="() const =0" -->
virtual uint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a7f54fcd57c88023b87f7e4535becab0a">GetLength</a> () const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b5a932a7f75ac57670997e45aee0060"></a><!-- doxytag: member="CFileDataIO::Eof" ref="a0b5a932a7f75ac57670997e45aee0060" args="() const " -->
virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a0b5a932a7f75ac57670997e45aee0060">Eof</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual uint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a220fae57611313cc14d63860c74ff449">Seek</a> (sint64 offset, wxSeekMode from=wxFromStart) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#af64cff2ab84643e7fdcd2b4366fece27">Read</a> (void *buffer, size_t count) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a4ea42d721c52cb8df7679f27e899a2e3">Write</a> (const void *buffer, size_t count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual wxString&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a6b7a23115528a2fa4893cd3d52178c96">ReadString</a> (bool bOptUTF8, uint8 lenBytes=2, bool SafeRead=false) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual wxString&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a0b054e41b6cac3b1cbfe7957d9da225b">ReadOnlyString</a> (bool bOptUTF8, uint16 length) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a9480e3cfad2ffcbe57670b6d00091ff2">WriteString</a> (const wxString &amp;str, EUtf8Str encoding=utf8strNone, uint8 lenBytes=2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac928bb561dc24f5b0d533d8a3d5dcbb1"></a><!-- doxytag: member="CFileDataIO::ReadTag" ref="ac928bb561dc24f5b0d533d8a3d5dcbb1" args="(bool bOptACP=false) const " -->
<a class="el" href="classCTag.html">CTag</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadTag</b> (bool bOptACP=false) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30a20542daecccedaa7895801d542c87"></a><!-- doxytag: member="CFileDataIO::ReadTagPtrList" ref="a30a20542daecccedaa7895801d542c87" args="(TagPtrList *taglist, bool bOptACP=false) const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadTagPtrList</b> (TagPtrList *taglist, bool bOptACP=false) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aedb11f781cf9c5794736cfae62737cf3"></a><!-- doxytag: member="CFileDataIO::WriteTag" ref="aedb11f781cf9c5794736cfae62737cf3" args="(const CTag &amp;tag)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteTag</b> (const <a class="el" href="classCTag.html">CTag</a> &amp;tag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa4e68226393b213bdc4ff1224c00b4bc"></a><!-- doxytag: member="CFileDataIO::WriteTagPtrList" ref="aa4e68226393b213bdc4ff1224c00b4bc" args="(const TagPtrList &amp;tagList)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteTagPtrList</b> (const TagPtrList &amp;tagList)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a07d0e8260ff4d2a9e6bac82f9cc3ce06"></a><!-- doxytag: member="CFileDataIO::GetIntTagValue" ref="a07d0e8260ff4d2a9e6bac82f9cc3ce06" args="() const " -->
uint64&nbsp;</td><td class="memItemRight" valign="bottom"><b>GetIntTagValue</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="affe6e4f4b3bb291929c6fd0a68b0076e"></a><!-- doxytag: member="CFileDataIO::IsEmpty" ref="affe6e4f4b3bb291929c6fd0a68b0076e" args="()" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>IsEmpty</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba766131c489f08fa02a79b4ccbdb12b"></a><!-- doxytag: member="CFileDataIO::Append" ref="aba766131c489f08fa02a79b4ccbdb12b" args="(const uint8 *buffer, int n)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>Append</b> (const uint8 *buffer, int n)</td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual sint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a82c6d4df3c99fd2838b4e3ec6d06f8d3">doSeek</a> (sint64 offset) const =0</td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#aa75c6ddae8a2b53e75f4c0bdbdbeb205">WriteStringCore</a> (const char *str, EUtf8Str encoding, uint8 lenBytes)</td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual uint8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a5208221bab44c2615a72e7609d9aacac">ReadUInt8</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5539266e4025c396390ce7f8048bdab2"></a><!-- doxytag: member="CFileDataIO::ReadUInt16" ref="a5539266e4025c396390ce7f8048bdab2" args="() const " -->
virtual uint16&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadUInt16</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab6ced46b496d303aa8148f950e0a91d7"></a><!-- doxytag: member="CFileDataIO::ReadUInt32" ref="ab6ced46b496d303aa8148f950e0a91d7" args="() const " -->
virtual uint32&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadUInt32</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2aedb82ec2f5b46296700f5324ff1e9c"></a><!-- doxytag: member="CFileDataIO::ReadUInt64" ref="a2aedb82ec2f5b46296700f5324ff1e9c" args="() const " -->
virtual uint64&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadUInt64</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4fc3dfba5eab16d70716b86327f9de21"></a><!-- doxytag: member="CFileDataIO::ReadUInt128" ref="a4fc3dfba5eab16d70716b86327f9de21" args="() const " -->
virtual <a class="el" href="classKademlia_1_1CUInt128.html">CUInt128</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadUInt128</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae817430f38a3480ae67da778c69cd6bd"></a><!-- doxytag: member="CFileDataIO::ReadHash" ref="ae817430f38a3480ae67da778c69cd6bd" args="() const " -->
virtual <a class="el" href="classCMD4Hash.html">CMD4Hash</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadHash</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd5073b6cb6dd16d8515714897473225"></a><!-- doxytag: member="CFileDataIO::ReadFloat" ref="acd5073b6cb6dd16d8515714897473225" args="() const " -->
virtual float&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadFloat</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a88fe093dc71501964993da2dedeb6357"></a><!-- doxytag: member="CFileDataIO::ReadBsob" ref="a88fe093dc71501964993da2dedeb6357" args="(uint8 *size) const " -->
virtual unsigned char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadBsob</b> (uint8 *size) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#ab1e35f980795d5ea66c358a4a43872d8">WriteUInt8</a> (uint8 value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8259e0910b87a274202f3c0bb65d30cc"></a><!-- doxytag: member="CFileDataIO::WriteUInt16" ref="a8259e0910b87a274202f3c0bb65d30cc" args="(uint16 value)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteUInt16</b> (uint16 value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08b76e4e173359cf43ca3deee2472e61"></a><!-- doxytag: member="CFileDataIO::WriteUInt32" ref="a08b76e4e173359cf43ca3deee2472e61" args="(uint32 value)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteUInt32</b> (uint32 value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5513445bed6b6eec31acc91e9a857a12"></a><!-- doxytag: member="CFileDataIO::WriteUInt64" ref="a5513445bed6b6eec31acc91e9a857a12" args="(uint64 value)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteUInt64</b> (uint64 value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4caddc62fc7dbcc1db2d555f1c20d14b"></a><!-- doxytag: member="CFileDataIO::WriteUInt128" ref="a4caddc62fc7dbcc1db2d555f1c20d14b" args="(const CUInt128 &amp;value)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteUInt128</b> (const <a class="el" href="classKademlia_1_1CUInt128.html">CUInt128</a> &amp;value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c3adac8abcaa7ca7fdc9537772aac97"></a><!-- doxytag: member="CFileDataIO::WriteHash" ref="a3c3adac8abcaa7ca7fdc9537772aac97" args="(const CMD4Hash &amp;value)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteHash</b> (const <a class="el" href="classCMD4Hash.html">CMD4Hash</a> &amp;value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa88379b92ca41cb5a637843b89693d7a"></a><!-- doxytag: member="CFileDataIO::WriteFloat" ref="aa88379b92ca41cb5a637843b89693d7a" args="(float value)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteFloat</b> (float value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa286c1a7a002db89bdc5e0e66443a8a1"></a><!-- doxytag: member="CFileDataIO::WriteBsob" ref="aa286c1a7a002db89bdc5e0e66443a8a1" args="(const unsigned char *val, uint8 size)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteBsob</b> (const unsigned char *val, uint8 size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual sint64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCFileDataIO.html#a675efe875eee7c667e2ff1cf01e2c49f">doRead</a> (void *buffer, size_t count) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4f5231a4275363ff2846208447927ae8"></a><!-- doxytag: member="CFileDataIO::doWrite" ref="a4f5231a4275363ff2846208447927ae8" args="(const void *buffer, size_t count)=0" -->
virtual sint64&nbsp;</td><td class="memItemRight" valign="bottom"><b>doWrite</b> (const void *buffer, size_t count)=0</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This class provides a interface for safe file IO. </p>
<p>Basic IO operations will either succeed or throw an exception, so that failure cannot be ignored. There are currently 3 types of failures: Read past EOF, errors while reading, and errors while writing.</p>
<p>Beyond basic IO, the interface provides functions for reading and writing a number of simple data-types. These are all written and read as little-endian in order to allow for communication across platforms.</p>
<p>Note that when empty areas are created, for instance by seeking past the end, then writing, the value of bytes where no data was explicitly written is not specified. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a675efe875eee7c667e2ff1cf01e2c49f"></a><!-- doxytag: member="CFileDataIO::doRead" ref="a675efe875eee7c667e2ff1cf01e2c49f" args="(void *buffer, size_t count) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual sint64 CFileDataIO::doRead </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The actual read / write function, as implemented by subclasses. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>The buffer to read data into / write data from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>The number of bytes to read / written. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes read / written or -1 in case of errors.</dd></dl>
<p>Note that the return value must be the actual number of bytes read or written, with the exception that in case of errors, -1 may be returned. This is because the return value is used to detect if the operation succeded.</p>
<p>This function should not throw Either of the CSafeIOExceptions, this is done by the CSafeFileIO::Read and the CSafeFileIO::Write functions. </p>

<p>Implemented in <a class="el" href="classCFile.html#a196bbaa7720510c1b63c966666b7421f">CFile</a>, and <a class="el" href="classCMemFile.html#a1e0640b805b905fcb917163be91b1b16">CMemFile</a>.</p>

<p>Referenced by <a class="el" href="SafeFile_8cpp_source.html#l00072">Read()</a>.</p>

</div>
</div>
<a class="anchor" id="a82c6d4df3c99fd2838b4e3ec6d06f8d3"></a><!-- doxytag: member="CFileDataIO::doSeek" ref="a82c6d4df3c99fd2838b4e3ec6d06f8d3" args="(sint64 offset) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual sint64 CFileDataIO::doSeek </td>
          <td>(</td>
          <td class="paramtype">sint64&nbsp;</td>
          <td class="paramname"> <em>offset</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The actual seek function, as implemented by subclasses. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>The absolute offset to seek to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The resulting offset.</dd></dl>
<p>This function should not throw of the CSafeIOExceptions, this is handled by the CSafeFileIO::Seek. At the moment, seeks that fail are considered a fatal error. </p>

<p>Implemented in <a class="el" href="classCFile.html#a882df4b2f143b5aa7bfac2504ddadf13">CFile</a>, and <a class="el" href="classCMemFile.html#ae0b38288239fd29aa0b9517f106ebe00">CMemFile</a>.</p>

<p>Referenced by <a class="el" href="SafeFile_8cpp_source.html#l00100">Seek()</a>.</p>

</div>
</div>
<a class="anchor" id="af64cff2ab84643e7fdcd2b4366fece27"></a><!-- doxytag: member="CFileDataIO::Read" ref="af64cff2ab84643e7fdcd2b4366fece27" args="(void *buffer, size_t count) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CFileDataIO::Read </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads 'count' bytes into 'buffer'. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>The target buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>The number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<p>Note that Read will read the specified number of bytes unless this would read past the end of the file. In that case, a <a class="el" href="structCEOFException.html" title="This exception is thrown when attempts are made at reading past the end of the file...">CEOFException</a> is thrown and the position and target buffer is left unchanged.</p>
<p>However, it is also possible that the read will fail due to IO errors (bad hardware, ect), in which case an <a class="el" href="structCIOFailureException.html" title="This exception reflects a failure in performing basic IO operations read and write...">CIOFailureException</a> will be thrown. </p>

<p>References <a class="el" href="classCFileDataIO.html#a675efe875eee7c667e2ff1cf01e2c49f">doRead()</a>, and <a class="el" href="SafeFile_8cpp_source.html#l00066">Eof()</a>.</p>

<p>Referenced by <a class="el" href="ThreadTasks_8cpp_source.html#l00333">CAICHSyncTask::ConvertToKnown2ToKnown264()</a>, <a class="el" href="FileAutoClose_8cpp_source.html#l00092">CFileAutoClose::ReadAt()</a>, <a class="el" href="SafeFile_8cpp_source.html#l00230">ReadOnlyString()</a>, and <a class="el" href="SafeFile_8cpp_source.html#l00130">ReadUInt8()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b054e41b6cac3b1cbfe7957d9da225b"></a><!-- doxytag: member="CFileDataIO::ReadOnlyString" ref="a0b054e41b6cac3b1cbfe7957d9da225b" args="(bool bOptUTF8, uint16 length) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wxString CFileDataIO::ReadOnlyString </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>bOptUTF8</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads a string from the file, where the length is specified directly. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bOptUTF8</em>&nbsp;</td><td>Specifies if the string is UTF8 encoded. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The resulting text-string.</dd></dl>
<p>This function is typically used when the text-fields length is not stored as an integer-field in front of the text-field. </p>

<p>References <a class="el" href="SafeFile_8cpp_source.html#l00072">Read()</a>.</p>

<p>Referenced by <a class="el" href="SafeFile_8cpp_source.html#l00211">ReadString()</a>.</p>

</div>
</div>
<a class="anchor" id="a6b7a23115528a2fa4893cd3d52178c96"></a><!-- doxytag: member="CFileDataIO::ReadString" ref="a6b7a23115528a2fa4893cd3d52178c96" args="(bool bOptUTF8, uint8 lenBytes=2, bool SafeRead=false) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wxString CFileDataIO::ReadString </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>bOptUTF8</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8&nbsp;</td>
          <td class="paramname"> <em>lenBytes</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>SafeRead</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads a string from the file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bOptUTF8</em>&nbsp;</td><td>Specifies if the string is UTF8 encoded. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lenBytes</em>&nbsp;</td><td>The number of bytes used to store the string length. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SafeRead</em>&nbsp;</td><td>Avoids throwing <a class="el" href="structCEOFException.html" title="This exception is thrown when attempts are made at reading past the end of the file...">CEOFException</a>, see below. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The resulting text-string.</dd></dl>
<p>Note that when SafeRead is set to true, CSafeFileIO will crop the length read from the lenght-field (see lenBytes), so that at most <a class="el" href="classCFileDataIO.html#a7f54fcd57c88023b87f7e4535becab0a" title="Must return the length of the file-object in bytes.">GetLength()</a> - <a class="el" href="classCFileDataIO.html#a6b153f389378a4f72ac09c56a6a60230" title="Must return the current position in the file.">GetPosition()</a> bytes are read.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>CSafeFileIO::Read </dd></dl>

<p>References <a class="el" href="classCFileDataIO.html#a7f54fcd57c88023b87f7e4535becab0a">GetLength()</a>, <a class="el" href="classCFileDataIO.html#a6b153f389378a4f72ac09c56a6a60230">GetPosition()</a>, and <a class="el" href="SafeFile_8cpp_source.html#l00230">ReadOnlyString()</a>.</p>

</div>
</div>
<a class="anchor" id="a5208221bab44c2615a72e7609d9aacac"></a><!-- doxytag: member="CFileDataIO::ReadUInt8" ref="a5208221bab44c2615a72e7609d9aacac" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8 CFileDataIO::ReadUInt8 </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads the given type from the file, stored as little-endian. </p>
<dl class="see"><dt><b>See also:</b></dt><dd>CSafeFileIO::Read </dd></dl>

<p>References <a class="el" href="SafeFile_8cpp_source.html#l00072">Read()</a>.</p>

<p>Referenced by <a class="el" href="Preferences_8cpp_source.html#l00924">CPreferences::CPreferences()</a>, <a class="el" href="ThreadTasks_8cpp_source.html#l00265">CAICHSyncTask::Entry()</a>, and <a class="el" href="SearchList_8cpp_source.html#l00473">CSearchList::ProcessSharedFileList()</a>.</p>

</div>
</div>
<a class="anchor" id="a220fae57611313cc14d63860c74ff449"></a><!-- doxytag: member="CFileDataIO::Seek" ref="a220fae57611313cc14d63860c74ff449" args="(sint64 offset, wxSeekMode from=wxFromStart) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64 CFileDataIO::Seek </td>
          <td>(</td>
          <td class="paramtype">sint64&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wxSeekMode&nbsp;</td>
          <td class="paramname"> <em>from</em> = <code>wxFromStart</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Changes the file position. </p>
<p>Note that seeking to an negative position is an illegal operation.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>wxFile::Seek </dd></dl>

<p>References <a class="el" href="classCFileDataIO.html#a82c6d4df3c99fd2838b4e3ec6d06f8d3">doSeek()</a>, <a class="el" href="classCFileDataIO.html#a7f54fcd57c88023b87f7e4535becab0a">GetLength()</a>, and <a class="el" href="classCFileDataIO.html#a6b153f389378a4f72ac09c56a6a60230">GetPosition()</a>.</p>

<p>Referenced by <a class="el" href="ThreadTasks_8cpp_source.html#l00529">CAllocateFileTask::Entry()</a>, <a class="el" href="ThreadTasks_8cpp_source.html#l00265">CAICHSyncTask::Entry()</a>, <a class="el" href="SearchList_8cpp_source.html#l00967">CSearchList::KademliaSearchKeyword()</a>, <a class="el" href="DownloadQueue_8cpp_source.html#l01343">CDownloadQueue::OnHostnameResolved()</a>, <a class="el" href="FileAutoClose_8cpp_source.html#l00092">CFileAutoClose::ReadAt()</a>, and <a class="el" href="FileAutoClose_8cpp_source.html#l00099">CFileAutoClose::WriteAt()</a>.</p>

</div>
</div>
<a class="anchor" id="a4ea42d721c52cb8df7679f27e899a2e3"></a><!-- doxytag: member="CFileDataIO::Write" ref="a4ea42d721c52cb8df7679f27e899a2e3" args="(const void *buffer, size_t count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CFileDataIO::Write </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write 'count' bytes from 'buffer' into the file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>The source-data buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>The number of bytes to write.</td></tr>
  </table>
  </dd>
</dl>
<p>Note that Write will throw a <a class="el" href="structCIOFailureException.html" title="This exception reflects a failure in performing basic IO operations read and write...">CIOFailureException</a> if it fails to write the specified number of bytes, which can be caused by hardware failures, lack of free space, etc. </p>

<p>Referenced by <a class="el" href="ThreadTasks_8cpp_source.html#l00333">CAICHSyncTask::ConvertToKnown2ToKnown264()</a>, <a class="el" href="ThreadTasks_8cpp_source.html#l00529">CAllocateFileTask::Entry()</a>, <a class="el" href="FileAutoClose_8cpp_source.html#l00099">CFileAutoClose::WriteAt()</a>, <a class="el" href="SafeFile_8cpp_source.html#l00342">WriteStringCore()</a>, and <a class="el" href="SafeFile_8cpp_source.html#l00261">WriteUInt8()</a>.</p>

</div>
</div>
<a class="anchor" id="a9480e3cfad2ffcbe57670b6d00091ff2"></a><!-- doxytag: member="CFileDataIO::WriteString" ref="a9480e3cfad2ffcbe57670b6d00091ff2" args="(const wxString &amp;str, EUtf8Str encoding=utf8strNone, uint8 lenBytes=2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CFileDataIO::WriteString </td>
          <td>(</td>
          <td class="paramtype">const wxString &amp;&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EUtf8Str&nbsp;</td>
          <td class="paramname"> <em>encoding</em> = <code>utf8strNone</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8&nbsp;</td>
          <td class="paramname"> <em>lenBytes</em> = <code>2</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes a text-string to the file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>The string to be written. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>encoding</em>&nbsp;</td><td>The text-ecoding, see EUtf8Str. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lenBytes</em>&nbsp;</td><td>The number of bytes used to store the string length.</td></tr>
  </table>
  </dd>
</dl>
<p>Valid values for the 'lenBytes' parameters is 0 bytes (no length field), 2 bytes and 4 bytes.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>CSafeFileIO::Write </dd></dl>

<p>References <a class="el" href="SafeFile_8cpp_source.html#l00342">WriteStringCore()</a>.</p>

<p>Referenced by <a class="el" href="BaseClient_8cpp_source.html#l02482">CUpDownClient::SendChatMessage()</a>.</p>

</div>
</div>
<a class="anchor" id="aa75c6ddae8a2b53e75f4c0bdbdbeb205"></a><!-- doxytag: member="CFileDataIO::WriteStringCore" ref="aa75c6ddae8a2b53e75f4c0bdbdbeb205" args="(const char *str, EUtf8Str encoding, uint8 lenBytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CFileDataIO::WriteStringCore </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EUtf8Str&nbsp;</td>
          <td class="paramname"> <em>encoding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8&nbsp;</td>
          <td class="paramname"> <em>lenBytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Helper-function that does the actual writing of the string. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>The string to be written. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>encoding</em>&nbsp;</td><td>The encoding of the string. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lenBytes</em>&nbsp;</td><td>The number of bytes used to store the string length. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="SafeFile_8cpp_source.html#l00090">Write()</a>.</p>

<p>Referenced by <a class="el" href="SafeFile_8cpp_source.html#l00322">WriteString()</a>.</p>

</div>
</div>
<a class="anchor" id="ab1e35f980795d5ea66c358a4a43872d8"></a><!-- doxytag: member="CFileDataIO::WriteUInt8" ref="ab1e35f980795d5ea66c358a4a43872d8" args="(uint8 value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CFileDataIO::WriteUInt8 </td>
          <td>(</td>
          <td class="paramtype">uint8&nbsp;</td>
          <td class="paramname"> <em>value</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes a value of the given type to the file, storing it as little-endian. </p>
<dl class="see"><dt><b>See also:</b></dt><dd>CSafeFileIO::Write </dd></dl>

<p>References <a class="el" href="SafeFile_8cpp_source.html#l00090">Write()</a>.</p>

<p>Referenced by <a class="el" href="DownloadQueue_8cpp_source.html#l00233">CDownloadQueue::AddSearchToDownload()</a>, <a class="el" href="ThreadTasks_8cpp_source.html#l00333">CAICHSyncTask::ConvertToKnown2ToKnown264()</a>, <a class="el" href="ThreadTasks_8cpp_source.html#l00529">CAllocateFileTask::Entry()</a>, <a class="el" href="ThreadTasks_8cpp_source.html#l00265">CAICHSyncTask::Entry()</a>, and <a class="el" href="DownloadQueue_8cpp_source.html#l01343">CDownloadQueue::OnHostnameResolved()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="SafeFile_8h_source.html">SafeFile.h</a></li>
<li>src/SafeFile.cpp</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 4 Dec 2014 for aMule by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
