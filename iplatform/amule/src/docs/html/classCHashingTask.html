<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>aMule: CHashingTask Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CHashingTask Class Reference</h1><!-- doxytag: class="CHashingTask" --><!-- doxytag: inherits="CThreadTask" -->
<p>This task performs MD4 and/or AICH hashings of a file, depending on the type.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ThreadTasks_8h_source.html">ThreadTasks.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CHashingTask:</div>
<div class="dynsection">
 <div class="center">
  <img src="classCHashingTask.gif" usemap="#CHashingTask_map" alt=""/>
  <map id="CHashingTask_map" name="CHashingTask_map">
<area href="classCThreadTask.html" alt="CThreadTask" shape="rect" coords="0,0,93,24"/>
</map>
 </div>
</div>

<p><a href="classCHashingTask-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a739f5de2317aabd896349bf89e7d901a">CHashingTask</a> (const <a class="el" href="classCPath.html">CPath</a> &amp;path, const <a class="el" href="classCPath.html">CPath</a> &amp;filename, const <a class="el" href="classCPartFile.html">CPartFile</a> *part=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a49d54b3b92bb133eee306d100a3c53ef">CHashingTask</a> (const <a class="el" href="classCKnownFile.html">CKnownFile</a> *toAICHHash)</td></tr>
<tr><td colspan="2"><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#acd8e2421038ebd748ef82f6dc4aa1286">EHashes</a> { <b>EH_AICH</b> =  1, 
<b>EH_MD4</b> =  2
 }</td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a87266d8af8bbab477f854e8af6a171d8">OnLastTask</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a5be9891c855b55cc1ced07b509079217">Entry</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#aabb481353351461ced82de1d0bddf43d">CreateNextPartHash</a> (<a class="el" href="classCFileAutoClose.html">CFileAutoClose</a> &amp;file, uint16 part, <a class="el" href="classCKnownFile.html">CKnownFile</a> *owner, <a class="el" href="classCHashingTask.html#acd8e2421038ebd748ef82f6dc4aa1286">EHashes</a> toHash)</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03d8790d6202c03fee3ac807ef721617"></a><!-- doxytag: member="CHashingTask::m_path" ref="a03d8790d6202c03fee3ac807ef721617" args="" -->
<a class="el" href="classCPath.html">CPath</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a03d8790d6202c03fee3ac807ef721617">m_path</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae88bfe0710980f4442586b36f3da19a1"></a><!-- doxytag: member="CHashingTask::m_filename" ref="ae88bfe0710980f4442586b36f3da19a1" args="" -->
<a class="el" href="classCPath.html">CPath</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#ae88bfe0710980f4442586b36f3da19a1">m_filename</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ec294fa2feb7d41184f0d4874673fee"></a><!-- doxytag: member="CHashingTask::m_toHash" ref="a9ec294fa2feb7d41184f0d4874673fee" args="" -->
<a class="el" href="classCHashingTask.html#acd8e2421038ebd748ef82f6dc4aa1286">EHashes</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a9ec294fa2feb7d41184f0d4874673fee">m_toHash</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7d84c493f7c69b78df81e1c96e7cf7ef"></a><!-- doxytag: member="CHashingTask::m_owner" ref="a7d84c493f7c69b78df81e1c96e7cf7ef" args="" -->
const <a class="el" href="classCKnownFile.html">CKnownFile</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCHashingTask.html#a7d84c493f7c69b78df81e1c96e7cf7ef">m_owner</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This task performs MD4 and/or AICH hashings of a file, depending on the type. </p>
<p>For new shared files (using the first constructor, with part == NULL), both MD4 and AICH hashes are created. For incomplete partfiles (rehashed due to changed timestamps), only MD4 hashing is done. For complete partfiles, both MD4 and AICH hashing is done.</p>
<p>For existing shared files (using the second constructor), only an AICH hash is created.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classCHashingEvent.html" title="This event is used to signal the completion of a hashing event.">CHashingEvent</a> </dd>
<dd>
<a class="el" href="classCAICHSyncTask.html" title="This task synchronizes the AICH hashlist.">CAICHSyncTask</a> </dd></dl>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a739f5de2317aabd896349bf89e7d901a"></a><!-- doxytag: member="CHashingTask::CHashingTask" ref="a739f5de2317aabd896349bf89e7d901a" args="(const CPath &amp;path, const CPath &amp;filename, const CPartFile *part=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CHashingTask::CHashingTask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCPath.html">CPath</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCPath.html">CPath</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCPartFile.html">CPartFile</a> *&nbsp;</td>
          <td class="paramname"> <em>part</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Schedules a partfile or new shared file for hashing. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>path</em>&nbsp;</td><td>The full path, without filename. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>The actual filename. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>part</em>&nbsp;</td><td>Used to identify the owner in the event-handler (PartFiles only).</td></tr>
  </table>
  </dd>
</dl>
<p>CHashingEvents sent by this type of tasks have the id MULE_EVT_HASHING. </p>
<dl class="see"><dt><b>See also:</b></dt><dd>EVT_MULE_HASHING </dd></dl>

<p>References <a class="el" href="ThreadTasks_8h_source.html#l00110">m_toHash</a>.</p>

</div>
</div>
<a class="anchor" id="a49d54b3b92bb133eee306d100a3c53ef"></a><!-- doxytag: member="CHashingTask::CHashingTask" ref="a49d54b3b92bb133eee306d100a3c53ef" args="(const CKnownFile *toAICHHash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CHashingTask::CHashingTask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCKnownFile.html">CKnownFile</a> *&nbsp;</td>
          <td class="paramname"> <em>toAICHHash</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Schedules a KnownFile to have a AICH hashset created, used by <a class="el" href="classCAICHSyncTask.html" title="This task synchronizes the AICH hashlist.">CAICHSyncTask</a>. </p>
<p>CHashingEvents sent by this type of tasks have the id MULE_EVT_AICH_HASHING. </p>
<dl class="see"><dt><b>See also:</b></dt><dd>EVT_MULE_AICH_HASHING </dd></dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aabb481353351461ced82de1d0bddf43d"></a><!-- doxytag: member="CHashingTask::CreateNextPartHash" ref="aabb481353351461ced82de1d0bddf43d" args="(CFileAutoClose &amp;file, uint16 part, CKnownFile *owner, EHashes toHash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CHashingTask::CreateNextPartHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCFileAutoClose.html">CFileAutoClose</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16&nbsp;</td>
          <td class="paramname"> <em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCKnownFile.html">CKnownFile</a> *&nbsp;</td>
          <td class="paramname"> <em>owner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCHashingTask.html#acd8e2421038ebd748ef82f6dc4aa1286">EHashes</a>&nbsp;</td>
          <td class="paramname"> <em>toHash</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Helper function for hashing a PARTSIZE chunk of a file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>The file to read from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>part</em>&nbsp;</td><td>The number of the part to hash. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>owner</em>&nbsp;</td><td>The known- (or part) file representing that file.  createAICH Specifies if AICH hash-sets should be created as well. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns false on read-errors, true otherwise.</dd></dl>
<p>This function will create a MD4 hash and, if specified, a AICH hashset for the next part of the file. This function makes the assumption that it wont be called for closed or EOF files. </p>

<p>References <a class="el" href="FileAutoClose_8cpp_source.html#l00106">CFileAutoClose::Eof()</a>.</p>

<p>Referenced by <a class="el" href="ThreadTasks_8cpp_source.html#l00083">Entry()</a>.</p>

</div>
</div>
<a class="anchor" id="a5be9891c855b55cc1ced07b509079217"></a><!-- doxytag: member="CHashingTask::Entry" ref="a5be9891c855b55cc1ced07b509079217" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CHashingTask::Entry </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classCThreadTask.html#aa771d4d2ec87cb3c73c8d75e12e1a3ec">CThreadTask::Entry</a> </dd></dl>

<p>Implements <a class="el" href="classCThreadTask.html#aa771d4d2ec87cb3c73c8d75e12e1a3ec">CThreadTask</a>.</p>

<p>References <a class="el" href="ThreadTasks_8cpp_source.html#l00207">CreateNextPartHash()</a>, <a class="el" href="ScopedPtr_8h_source.html#l00064">CScopedPtr&lt; TYPE &gt;::get()</a>, <a class="el" href="FileAutoClose_8cpp_source.html#l00071">CFileAutoClose::GetLength()</a>, <a class="el" href="Path_8cpp_source.html#l00652">CPath::GetModificationTime()</a>, <a class="el" href="Path_8cpp_source.html#l00468">CPath::JoinPaths()</a>, <a class="el" href="ThreadTasks_8h_source.html#l00108">m_filename</a>, <a class="el" href="ThreadTasks_8h_source.html#l00112">m_owner</a>, <a class="el" href="ThreadTasks_8h_source.html#l00106">m_path</a>, <a class="el" href="ThreadTasks_8h_source.html#l00110">m_toHash</a>, <a class="el" href="FileAutoClose_8cpp_source.html#l00046">CFileAutoClose::Open()</a>, <a class="el" href="ScopedPtr_8h_source.html#l00070">CScopedPtr&lt; TYPE &gt;::release()</a>, and <a class="el" href="ThreadScheduler_8cpp_source.html#l00363">CThreadTask::TestDestroy()</a>.</p>

</div>
</div>
<a class="anchor" id="a87266d8af8bbab477f854e8af6a171d8"></a><!-- doxytag: member="CHashingTask::OnLastTask" ref="a87266d8af8bbab477f854e8af6a171d8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CHashingTask::OnLastTask </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classCThreadTask.html#a5eac5242e620a396e9027185ff141ff4" title="Called when the last task of a specific type has been completed.">CThreadTask::OnLastTask</a> </dd></dl>

<p>Reimplemented from <a class="el" href="classCThreadTask.html#a5eac5242e620a396e9027185ff141ff4">CThreadTask</a>.</p>

<p>References <a class="el" href="ThreadScheduler_8cpp_source.html#l00105">CThreadScheduler::AddTask()</a>, and <a class="el" href="ThreadScheduler_8cpp_source.html#l00371">CThreadTask::GetType()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="ThreadTasks_8h_source.html">ThreadTasks.h</a></li>
<li>src/ThreadTasks.cpp</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 4 Dec 2014 for aMule by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
