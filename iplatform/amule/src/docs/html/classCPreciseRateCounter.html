<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>aMule: CPreciseRateCounter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CPreciseRateCounter Class Reference</h1><!-- doxytag: class="CPreciseRateCounter" -->
<p>Counts precise rate/average on added bytes/values.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Statistics_8h_source.html">Statistics.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CPreciseRateCounter:</div>
<div class="dynsection">
 <div class="center">
  <img src="classCPreciseRateCounter.gif" usemap="#CPreciseRateCounter_map" alt=""/>
  <map id="CPreciseRateCounter_map" name="CPreciseRateCounter_map">
<area href="classCStatTreeItemRateCounter.html" alt="CStatTreeItemRateCounter" shape="rect" coords="0,56,160,80"/>
</map>
 </div>
</div>

<p><a href="classCPreciseRateCounter-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#a47a104a2d2dc3f19238088d35f072a09">CPreciseRateCounter</a> (uint32_t timespan, bool count_average=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#ac9827a5e5d40535b415a55f6d7c41932">CalculateRate</a> (uint64_t now)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#a066b83fa244fc740a4096fecbb36c797">GetRate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#ac91de7ac3b4bd0c41153d180357b6cd7">GetMaxRate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#af696df568067519f269b63decf1d4c04">SetTimespan</a> (uint32_t timespan)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a19876de2e6216d037d49994bc9bd03d1"></a><!-- doxytag: member="CPreciseRateCounter::operator+=" ref="a19876de2e6216d037d49994bc9bd03d1" args="(uint32_t bytes)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#a19876de2e6216d037d49994bc9bd03d1">operator+=</a> (uint32_t bytes)</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa63ba8a8b43f5fa845b77bccd6dbafaf"></a><!-- doxytag: member="CPreciseRateCounter::m_byte_history" ref="aa63ba8a8b43f5fa845b77bccd6dbafaf" args="" -->
std::deque&lt; uint32 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_byte_history</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abf40f2e2b13cb517828d8500833b4797"></a><!-- doxytag: member="CPreciseRateCounter::m_tick_history" ref="abf40f2e2b13cb517828d8500833b4797" args="" -->
std::deque&lt; uint64 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_tick_history</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a16efab7437091165d7f400ed9bbd4a"></a><!-- doxytag: member="CPreciseRateCounter::m_timespan" ref="a4a16efab7437091165d7f400ed9bbd4a" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_timespan</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab8a2529e67cb46a5bfc096069b6bdafc"></a><!-- doxytag: member="CPreciseRateCounter::m_total" ref="ab8a2529e67cb46a5bfc096069b6bdafc" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_total</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abfd12f1ee6b22ab6a1f90fe27e47d617"></a><!-- doxytag: member="CPreciseRateCounter::m_rate" ref="abfd12f1ee6b22ab6a1f90fe27e47d617" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_rate</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5362dc82cf56d5ee1a9a4bb7cad8c952"></a><!-- doxytag: member="CPreciseRateCounter::m_max_rate" ref="a5362dc82cf56d5ee1a9a4bb7cad8c952" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_max_rate</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a41b9c5127d3aa56a2e59b96c358ff0a7"></a><!-- doxytag: member="CPreciseRateCounter::m_tmp_sum" ref="a41b9c5127d3aa56a2e59b96c358ff0a7" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_tmp_sum</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aace2419b92b0f22c71aabb6a2bd589ba"></a><!-- doxytag: member="CPreciseRateCounter::m_mutex" ref="aace2419b92b0f22c71aabb6a2bd589ba" args="" -->
wxMutex&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_mutex</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc5f6c4b84f2eb7e3a8ab422f96dba25"></a><!-- doxytag: member="CPreciseRateCounter::m_count_average" ref="abc5f6c4b84f2eb7e3a8ab422f96dba25" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_count_average</b></td></tr>
<tr><td colspan="2"><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa9c6e39ed43cb9206d8c131ee333ca5a"></a><!-- doxytag: member="CPreciseRateCounter::CStatistics" ref="aa9c6e39ed43cb9206d8c131ee333ca5a" args="" -->
class&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPreciseRateCounter.html#aa9c6e39ed43cb9206d8c131ee333ca5a">CStatistics</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Counts precise rate/average on added bytes/values. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This class is MT-safe. </dd></dl>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a47a104a2d2dc3f19238088d35f072a09"></a><!-- doxytag: member="CPreciseRateCounter::CPreciseRateCounter" ref="a47a104a2d2dc3f19238088d35f072a09" args="(uint32_t timespan, bool count_average=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CPreciseRateCounter::CPreciseRateCounter </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>timespan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>count_average</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timespan</em>&nbsp;</td><td>Desired timespan for rate calculations. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count_average</em>&nbsp;</td><td>Counts average instead of rate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac9827a5e5d40535b415a55f6d7c41932"></a><!-- doxytag: member="CPreciseRateCounter::CalculateRate" ref="ac9827a5e5d40535b415a55f6d7c41932" args="(uint64_t now)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CPreciseRateCounter::CalculateRate </td>
          <td>(</td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>now</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate current rate. </p>
<p>This function should be called reasonably often, to keep rates up-to-date, and prevent history growing to the skies. </p>

</div>
</div>
<a class="anchor" id="ac91de7ac3b4bd0c41153d180357b6cd7"></a><!-- doxytag: member="CPreciseRateCounter::GetMaxRate" ref="ac91de7ac3b4bd0c41153d180357b6cd7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CPreciseRateCounter::GetMaxRate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets ever seen maximal rate. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The maximal rate which occured. </dd></dl>

</div>
</div>
<a class="anchor" id="a066b83fa244fc740a4096fecbb36c797"></a><!-- doxytag: member="CPreciseRateCounter::GetRate" ref="a066b83fa244fc740a4096fecbb36c797" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CPreciseRateCounter::GetRate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get current rate. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Current rate in bytes/second. </dd></dl>

</div>
</div>
<a class="anchor" id="af696df568067519f269b63decf1d4c04"></a><!-- doxytag: member="CPreciseRateCounter::SetTimespan" ref="af696df568067519f269b63decf1d4c04" args="(uint32_t timespan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CPreciseRateCounter::SetTimespan </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>timespan</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets desired timespan for rate calculations. </p>
<p>If new timespan is greater than the old was, then the change takes effect with time. The exact time needed for the change to take effect is new minus old value of the timespan.</p>
<p>If the new timespan is lower than the old, the change takes effect immediately at the next call to <a class="el" href="classCPreciseRateCounter.html#ac9827a5e5d40535b415a55f6d7c41932" title="Calculate current rate.">CalculateRate()</a>. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="Statistics_8h_source.html">Statistics.h</a></li>
<li>src/Statistics.cpp</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 4 Dec 2014 for aMule by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
