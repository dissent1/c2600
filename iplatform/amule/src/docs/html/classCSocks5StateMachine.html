<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>aMule: CSocks5StateMachine Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CSocks5StateMachine Class Reference</h1><!-- doxytag: class="CSocks5StateMachine" --><!-- doxytag: inherits="CProxyStateMachine" --><div class="dynheader">
Inheritance diagram for CSocks5StateMachine:</div>
<div class="dynsection">
 <div class="center">
  <img src="classCSocks5StateMachine.gif" usemap="#CSocks5StateMachine_map" alt=""/>
  <map id="CSocks5StateMachine_map" name="CSocks5StateMachine_map">
<area href="classCProxyStateMachine.html" alt="CProxyStateMachine" shape="rect" coords="0,56,139,80"/>
<area href="classCStateMachine.html" alt="CStateMachine" shape="rect" coords="0,0,139,24"/>
</map>
 </div>
</div>

<p><a href="classCSocks5StateMachine-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSocks5StateMachine.html#a55fe2b069f653977fc183a2c044c7878">CSocks5StateMachine</a> (const <a class="el" href="classCProxyData.html">CProxyData</a> &amp;proxyData, CProxyCommand proxyCommand)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00d6c4a3dd4770882397c7e5a4cbf15c"></a><!-- doxytag: member="CSocks5StateMachine::process_state" ref="a00d6c4a3dd4770882397c7e5a4cbf15c" args="(t_sm_state state, bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_state</b> (t_sm_state state, bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">t_sm_state&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSocks5StateMachine.html#afe61fed0178f3b70fd950b32b37b4e5f">next_state</a> (t_sm_event event)</td></tr>
<tr><td colspan="2"><h2>Private Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><b>Socks5State</b> { <br/>
&nbsp;&nbsp;<b>SOCKS5_STATE_START</b> =  PROXY_STATE_START, 
<b>SOCKS5_STATE_END</b> =  PROXY_STATE_END, 
<b>SOCKS5_STATE_SEND_QUERY_AUTHENTICATION_METHOD</b>, 
<b>SOCKS5_STATE_RECEIVE_AUTHENTICATION_METHOD</b>, 
<br/>
&nbsp;&nbsp;<b>SOCKS5_STATE_PROCESS_AUTHENTICATION_METHOD</b>, 
<b>SOCKS5_STATE_SEND_AUTHENTICATION_GSSAPI</b>, 
<b>SOCKS5_STATE_RECEIVE_AUTHENTICATION_GSSAPI</b>, 
<b>SOCKS5_STATE_PROCESS_AUTHENTICATION_GSSAPI</b>, 
<br/>
&nbsp;&nbsp;<b>SOCKS5_STATE_SEND_AUTHENTICATION_USERNAME_PASSWORD</b>, 
<b>SOCKS5_STATE_RECEIVE_AUTHENTICATION_USERNAME_PASSWORD</b>, 
<b>SOCKS5_STATE_PROCESS_AUTHENTICATION_USERNAME_PASSWORD</b>, 
<b>SOCKS5_STATE_SEND_COMMAND_REQUEST</b>, 
<br/>
&nbsp;&nbsp;<b>SOCKS5_STATE_RECEIVE_COMMAND_REPLY</b>, 
<b>SOCKS5_STATE_PROCESS_COMMAND_REPLY</b>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSocks5StateMachine.html#acdd81d50aaad7e67c448671548c46532">process_start</a> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f4eb2625ebc44a5d8f3b053c160dbfd"></a><!-- doxytag: member="CSocks5StateMachine::process_send_query_authentication_method" ref="a6f4eb2625ebc44a5d8f3b053c160dbfd" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_send_query_authentication_method</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8bab4da06bc43b7e077f7f3a84c2cc46"></a><!-- doxytag: member="CSocks5StateMachine::process_receive_authentication_method" ref="a8bab4da06bc43b7e077f7f3a84c2cc46" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_receive_authentication_method</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a85bc320686ad44904e4eba1f907144cc"></a><!-- doxytag: member="CSocks5StateMachine::process_process_authentication_method" ref="a85bc320686ad44904e4eba1f907144cc" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_process_authentication_method</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a43f26d3fe85424015e4ec3d345ea0614"></a><!-- doxytag: member="CSocks5StateMachine::process_send_authentication_gssapi" ref="a43f26d3fe85424015e4ec3d345ea0614" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_send_authentication_gssapi</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a71ecad84fafef821fa28ae938b578ab5"></a><!-- doxytag: member="CSocks5StateMachine::process_receive_authentication_gssapi" ref="a71ecad84fafef821fa28ae938b578ab5" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_receive_authentication_gssapi</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af93cab5117fb0cb010be00c9a3c8548f"></a><!-- doxytag: member="CSocks5StateMachine::process_process_authentication_gssapi" ref="af93cab5117fb0cb010be00c9a3c8548f" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_process_authentication_gssapi</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2de32a27da420ae8c7575749ff1d018c"></a><!-- doxytag: member="CSocks5StateMachine::process_send_authentication_username_password" ref="a2de32a27da420ae8c7575749ff1d018c" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_send_authentication_username_password</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a828a78619c84c190fa6435a6bfc7eeb8"></a><!-- doxytag: member="CSocks5StateMachine::process_receive_authentication_username_password" ref="a828a78619c84c190fa6435a6bfc7eeb8" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_receive_authentication_username_password</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c3a4ee09e57e920c6037309d3f7f08f"></a><!-- doxytag: member="CSocks5StateMachine::process_process_authentication_username_password" ref="a1c3a4ee09e57e920c6037309d3f7f08f" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_process_authentication_username_password</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a415c336cc23a3bb370031c0bb726f37d"></a><!-- doxytag: member="CSocks5StateMachine::process_send_command_request" ref="a415c336cc23a3bb370031c0bb726f37d" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_send_command_request</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abb9345f11616771c1f14cab95f071bd1"></a><!-- doxytag: member="CSocks5StateMachine::process_receive_command_reply" ref="abb9345f11616771c1f14cab95f071bd1" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_receive_command_reply</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a62b63ef0b18733fc0cafd658fd498280"></a><!-- doxytag: member="CSocks5StateMachine::process_process_command_reply" ref="a62b63ef0b18733fc0cafd658fd498280" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_process_command_reply</b> (bool entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5ab603bc3728a32b2e6845cfa4fd319f"></a><!-- doxytag: member="CSocks5StateMachine::process_end" ref="a5ab603bc3728a32b2e6845cfa4fd319f" args="(bool entry)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>process_end</b> (bool entry)</td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2d4582d39eba26983e0adf9134aa8c53"></a><!-- doxytag: member="CSocks5StateMachine::m_process_state" ref="a2d4582d39eba26983e0adf9134aa8c53" args="[SOCKS5_MAX_STATES]" -->
Socks5StateProcessor&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_process_state</b> [SOCKS5_MAX_STATES]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adbecf9b6288c114507dd02388758d4b4"></a><!-- doxytag: member="CSocks5StateMachine::m_state_name" ref="adbecf9b6288c114507dd02388758d4b4" args="[SOCKS5_MAX_STATES]" -->
wxString&nbsp;</td><td class="memItemRight" valign="bottom"><b>m_state_name</b> [SOCKS5_MAX_STATES]</td></tr>
<tr><td colspan="2"><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d014b2a93a029dd9050d5c05dedd011"></a><!-- doxytag: member="CSocks5StateMachine::SOCKS5_MAX_STATES" ref="a0d014b2a93a029dd9050d5c05dedd011" args="" -->
static const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><b>SOCKS5_MAX_STATES</b> = 14</td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a55fe2b069f653977fc183a2c044c7878"></a><!-- doxytag: member="CSocks5StateMachine::CSocks5StateMachine" ref="a55fe2b069f653977fc183a2c044c7878" args="(const CProxyData &amp;proxyData, CProxyCommand proxyCommand)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CSocks5StateMachine::CSocks5StateMachine </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCProxyData.html">CProxyData</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>proxyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CProxyCommand&nbsp;</td>
          <td class="paramname"> <em>proxyCommand</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The state machine constructor must initialize the array of pointer to member functions. </p>
<p>Don't waste you time trying to statically initialize this, pointer to member functions require an object to operate on, so this array must be initialized at run time. </p>

<p>References <a class="el" href="Proxy_8cpp_source.html#l00567">process_start()</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="afe61fed0178f3b70fd950b32b37b4e5f"></a><!-- doxytag: member="CSocks5StateMachine::next_state" ref="afe61fed0178f3b70fd950b32b37b4e5f" args="(t_sm_event event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">t_sm_state CSocks5StateMachine::next_state </td>
          <td>(</td>
          <td class="paramtype">t_sm_event&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Code this such that the next state is only entered when it is able to perform the operation (read or write). </p>
<p>State processing will assume that it can read or write upon entry of the state. This is done using CanSend() and CanReceive(). On daemon, these functions always return true, because sockets are blocking. </p>

<p>Implements <a class="el" href="classCStateMachine.html">CStateMachine</a>.</p>

</div>
</div>
<a class="anchor" id="acdd81d50aaad7e67c448671548c46532"></a><!-- doxytag: member="CSocks5StateMachine::process_start" ref="acdd81d50aaad7e67c448671548c46532" args="(bool entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSocks5StateMachine::process_start </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>entry</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>So, this is how you do it: the state machine is clocked by the events that happen inside the event handler. </p>
<p>You can add a dummy event whenever you see that the system will not generate an event. But don't add dummy events before reads, reads should only be performed after input events.</p>
<p>Maybe it makes sense to add a dummy event before a read if there is no state change (wait state).</p>
<p>The event system will generate at least 2 events, one wxSOCKET_CONNECTION, one wxSOCKET_OUTPUT, so we will have 2 clocks in our state machine. Plus, each time there is unread data in the receive buffer of the socket, a wxSOCKET_INPUT event will be generated. If you feel you will need more clocks than these, use AddDummyEvent(), but I suggest you review your state machine design first. </p>

<p>Referenced by <a class="el" href="Proxy_8cpp_source.html#l00350">CSocks5StateMachine()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="Proxy_8h_source.html">Proxy.h</a></li>
<li>src/Proxy.cpp</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 4 Dec 2014 for aMule by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
